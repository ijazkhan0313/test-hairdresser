import{j as I,i as y,o as n,c as a,a as t,s as P,v as U,F as l,a6 as k,f as N,a8 as d,t as s,d as i,a2 as S}from"./C2egFmNW.js";const O={class:"row justify-content-center mt-5"},B={class:"col-12 my-4 col-sm-8"},E={class:"row g-3"},q={class:"col-md-9"},A=t("label",{for:"inputPassword2",class:"visually-hidden"},"Email address",-1),T={class:"card col-12 col-sm-8 mt-4"},j=t("div",{class:"card-header"},[t("h6",null,"Active Subscription")],-1),F={class:"card-body"},L={class:"table-responsive"},M={class:"table table-bordered"},V=t("thead",null,[t("tr",null,[t("th",{scope:"col"},"#"),t("th",{scope:"col"},"Subscription Name"),t("th",{scope:"col"},"Duration"),t("th",{scope:"col"},"Payment Method"),t("th",{scope:"col"},"Payment Type"),t("th",{scope:"col"},"Subscription Qty"),t("th",{scope:"col"},"Price"),t("th",{scope:"col"},"Status"),t("th",{scope:"col"},"Expiry Date"),t("th",{scope:"col"},"Invoice"),t("th",{scope:"col"},"Action")])],-1),Q={key:0},z=t("td",{colspan:"11",class:"text-center"},"No Cancelled Subscriptions available",-1),G=[z],H={scope:"row"},R=t("i",{class:"fas fa-university"},null,-1),Y=["onClick"],J=["onClick"],K={class:"card col-12 col-sm-8 mt-4"},W=t("div",{class:"card-header"},[t("h6",null,"Cancel Subscription")],-1),X={class:"card-body"},Z={class:"table-responsive"},tt={class:"table table-bordered"},et=t("thead",null,[t("tr",null,[t("th",{scope:"col"},"#"),t("th",{scope:"col"},"Subscription Name"),t("th",{scope:"col"},"Duration"),t("th",{scope:"col"},"Payment Method"),t("th",{scope:"col"},"Payment Type"),t("th",{scope:"col"},"Subscription Qty"),t("th",{scope:"col"},"Price"),t("th",{scope:"col"},"Status"),t("th",{scope:"col"},"Expiry Date"),t("th",{scope:"col"},"Invoice")])],-1),st={key:0},ot=t("td",{colspan:"11",class:"text-center"},"No Cancelled Subscriptions available",-1),nt=[ot],at={scope:"row"},ct=t("i",{class:"fas fa-university"},null,-1),lt=["onClick"],ut={__name:"subscription",setup(it){const u=I(),_=y([]),p=y([]),r=N().public.apiUrl;async function C(){try{const o=await d.post(`${r}/user-active-subscriptions`,{email:u.user.email});_.value=o.data.data,console.log("Fetched subscriptions:",o)}catch{this.$toast.error("Oops, something went wrong!")}}async function $(){try{const o=await d.post(`${r}/user-cancel-subscriptions`,{email:u.user.email});p.value=o.data.data}catch{this.$toast.error("Oops, something went wrong!")}}function v(o){const c={year:"numeric",month:"2-digit",day:"2-digit"};return new Date(o).toLocaleDateString(void 0,c)}function b(o){return o===1?"Active":"Cancelled"}function g(o){return o===0?"badge bg-warning":"badge bg-success"}$(),C();const h=y("");async function x(){if(h.value)try{await d.post(`${r}/invitations/send`,{email:h.value,inviter_id:u.user.id}),Swal.fire({title:"Good job!",text:"Inviateion email is sent successfully",icon:"success"})}catch{this.$toast.error("Oops, something went wrong!")}}const f=async o=>{try{const e=(await d.post(`${r}/download-invoice`,{invoiceId:o})).data.data.url;e?window.open(e):this.$toast.error("Oops, something went wrong!")}catch{this.$toast.error("Oops, something went wrong!")}};async function D(o){try{const c=await d.post(`${r}/cancel-subscriptions`,{email:u.user.email,subscription_id:o});_.value=c.data.data,Swal.fire({title:"Subscription Cancel!",text:"Your Subscriptionis is Canceled.",icon:"success"})}catch{this.$toast.error("Oops, something went wrong!")}}return(o,c)=>(n(),a("div",null,[t("div",O,[t("div",B,[t("div",E,[t("div",q,[A,P(t("input",{"onUpdate:modelValue":c[0]||(c[0]=e=>h.value=e),type:"text",class:"form-control",name:"email",placeholder:"Enter email","aria-describedby":"emailHelp"},null,512),[[U,h.value]])]),t("div",{class:"col-md-2"},[t("button",{class:"btn btn-primary",onClick:x}," Invite User ")])])]),t("div",T,[j,t("div",F,[t("div",L,[t("table",M,[V,t("tbody",null,[_.value.length===0?(n(),a("tr",Q,G)):(n(!0),a(l,{key:1},k(_.value,(e,m)=>(n(),a("tr",{key:e.id},[t("th",H,s(m+1),1),t("td",null,s(e.product_name),1),t("td",null,s(e.product_billing_frequency)+" "+s(e.product_billing_interval),1),t("td",null,[e.payment_method==="card"?(n(),a(l,{key:0},[i("Card")],64)):e.payment_method==="bank"?(n(),a(l,{key:1},[R,i(" Bank ")],64)):(n(),a(l,{key:2},[i(s(e.payment_method),1)],64))]),t("td",null,s(e.payment_type),1),t("td",null,s(e.product_quantity),1),t("td",null,"$"+s(e.product_price),1),t("td",null,[t("span",{class:S(g(e.status))},s(b(e.status)),3)]),t("td",null,s(v(e.expiry_date)),1),t("td",null,[t("button",{class:"btn btn-primary btn-sm",onClick:w=>f(e.paddle_transaction_id)}," Invoice ",8,Y)]),t("td",null,[t("button",{class:"btn btn-danger btn-sm",onClick:w=>D(e.subscription_id)}," Cancel ",8,J)])]))),128))])])])])]),t("div",K,[W,t("div",X,[t("div",Z,[t("table",tt,[et,t("tbody",null,[p.value.length===0?(n(),a("tr",st,nt)):(n(!0),a(l,{key:1},k(p.value,(e,m)=>(n(),a("tr",{key:e.id},[t("th",at,s(m+1),1),t("td",null,s(e.product_name),1),t("td",null,s(e.product_billing_frequency)+" "+s(e.product_billing_interval),1),t("td",null,[e.payment_method==="card"?(n(),a(l,{key:0},[i("Card")],64)):e.payment_method==="bank"?(n(),a(l,{key:1},[ct,i(" Bank ")],64)):(n(),a(l,{key:2},[i(s(e.payment_method),1)],64))]),t("td",null,s(e.payment_type),1),t("td",null,s(e.product_quantity),1),t("td",null,"$"+s(e.product_price),1),t("td",null,[t("span",{class:S(g(e.status))},s(b(e.status)),3)]),t("td",null,s(v(e.expiry_date)),1),t("td",null,[t("button",{class:"btn btn-primary btn-sm",onClick:w=>f(e.paddle_transaction_id)}," Invoice ",8,lt)])]))),128))])])])])])])]))}};export{ut as default};
