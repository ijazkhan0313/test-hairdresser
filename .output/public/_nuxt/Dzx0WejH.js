import{f as h,_ as G,r as N,o as r,c,a as s,t as m,g as p,b as u,w as l,F as y}from"./C2egFmNW.js";import{A as _}from"./lEC4QW_W.js";import{u as d,c as A}from"./C-QmXMO2.js";import{i as C}from"./DQqw_gti.js";import{i as T}from"./O97EOHsH.js";import{s as x}from"./CoS0jMrp.js";import{_ as v}from"./evITL-mf.js";import{_ as w}from"./lXXSD6iP.js";import"./C4iS2aBk.js";import"./CMS5Braa.js";import"./D3j8g8Cz.js";import"./Cq3l7X6R.js";const M={name:"NoiseMusicGain",components:{AudioElement:_},data(){return{audioContext:d().getContext(),playing:!1,paused:!1,createdNodes:{},fading:!1,noiseReady:!1,musicReady:!1,musicDevice:{},noiseDevice:{},forest_src:window.location.origin+h().public.forest_src,noise_src:window.location.origin+h().public.noise_src}},async beforeMount(){this.noiseDevice=await A(this.audioContext,C),this.musicDevice=await A(this.audioContext,T)},mounted(){},methods:{refreshAudioContext(){const e=new AudioContext;this.audioContext.close(),d().audioContext=e,this.audioContext=d().getContext()},fadeOutGains(){const e=this.audioContext.currentTime+1.3;this.fading=!0,this.createdNodes.noiseGain&&(this.createdNodes.noiseGain.gain.cancelScheduledValues(this.audioContext.currentTime),this.createdNodes.noiseGain.gain.linearRampToValueAtTime(0,this.audioContext.currentTime+3)),this.createdNodes.musicGain&&(this.createdNodes.musicGain.gain.cancelScheduledValues(this.audioContext.currentTime),this.createdNodes.musicGain.gain.linearRampToValueAtTime(0,this.audioContext.currentTime+3)),setTimeout(()=>{this.fading=!1},e*1e3)},fadeInGains(){const e=this.audioContext.currentTime+6;this.fading=!0;const o=this.createdNodes.noiseGain,n=this.createdNodes.musicGain;o.gain.linearRampToValueAtTime(1,e),n.gain.linearRampToValueAtTime(1,e),setTimeout(()=>{this.fading=!1},e*1e3)},async handlePlayingUpdate(e){if(!(!this.musicReady&&!this.noiseReady))if(e&&d().isPlaying()){const n=this.$refs.Noise.$refs.audioElement,i=this.$refs.Music.$refs.audioElement,t=this.audioContext;this.createdNodes.musicGain||=t.createGain(),this.createdNodes.noiseGain||=t.createGain(),this.createdNodes.musicGain.gain.setValueAtTime(0,t.currentTime),this.createdNodes.noiseGain.gain.setValueAtTime(0,t.currentTime),i.muted=!1,n.muted=!1,this.createdNodes.noiseSource=t.createMediaElementSource(n),this.createdNodes.musicSource=t.createMediaElementSource(i);const a=await x(this.createdNodes.noiseSource,this.createdNodes.musicSource);this.createdNodes.musicGain=a.pop(),this.createdNodes.noiseGain=a.pop(),this.fadeInGains()}else{if(this.fading)return;this.playing=!1,setTimeout(()=>{this.createdNodes=[],this.refreshAudioContext()},1500)}},updateNoiseGain(e){this.createdNodes.noiseGain&&this.createdNodes.noiseGain.gain.linearRampToValueAtTime(e,this.createdNodes.noiseGain.context.currentTime+.3)},updateMusicGain(e){this.createdNodes.musicGain&&this.createdNodes.musicGain.gain.linearRampToValueAtTime(e,this.createdNodes.musicGain.context.currentTime+.3)}}},R="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAAUCAYAAACAl21KAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAJOSURBVHgBnVS9ctNAEN7dO41nmDGVG6lK5VRUpsc0oXGqVOYB/AJ+AHgAeADnAZI+dkVlKhpUQYOrVFZF5UxmkHW7fKcYsGMHx9kZ6XS63e/22z+mhyShjlPXNsfHpLRgs3mQMKMl5bvU3dYP507Zy3s211CiwlhyY742olJITtjxW2EhM5ut2/H6Rry8w/tGiHJl6hFZtna8IOMCnv0AcBv7G62qj1tAABni3SS2FGuuSTKm29tiw91Goy0h9GHUgYf5fbCajiTuIj7YprRfUuiOJPEfyPvuPyDvr9i7q0eC/AWLdhGwZoSnbUyZGZ3juzgACInQCaLToWfw0HsPEFtQCBM6UHSpl3F1v1zHkcgZE89M9QsdLiVLTBC34iaN2aCnS23PMWOglrLnRfwbynD5GGtJZMDKcxPJWHXugNRHyI9xdoTjn+xQI2r5PhCymtIL1B3skK5V+lKXJBd3SnUtNf+D01zp0JrNyLHwS3MepR9aWBdMWqLKjyzY910oCMUbNfqGZiMEOjOnaGiXCRvnQqGj7MZioRtTCp3uQ+6YoAdDyFE3fTT1FLFpq9lXtE6Ywrk2LZc5bnhFsTlXFHbg/Kn8ArHJqKqmZHQK4M9xjJQYDWd39BRe+hJuLjAy0vujArReY4LEDLVArIXam7O4DOun2CKYW3IupAPQm8YVaS1MNkbIipalwWQGSj10/aimxzyuL6k1VAuUQReelKjyEyXDmJAJ/l9vADmPStEhhk8TLBros+dWVVt118QNQ/jfo32C0SFJMliP428sFvX4guAEJgAAAABJRU5ErkJggg==",U=s("h1",null,"Test Version NoiseMusicGain: mit WebAudio & Gain und PlayPause, Laden von Devices",-1),E=s("p",null," The method refreshAudioContext helps to get the ressources free when we stop playing the audio // without it would be louder each time we start playing ",-1),S=s("p",null," Whenever I view this page the audio starts playing, when I hit 'space' it fades out within 2seconds when i start playing again nothing happens... I would expect playing. ",-1),V={key:0},P={key:1},B=s("div",{class:"icon"},[s("img",{style:{width:"25px"},src:R})],-1),D=s("div",{class:"icon"},[s("img",{style:{width:"25px"},src:v})],-1),I=s("div",{class:"icon"},[s("img",{style:{width:"25px"},src:w})],-1);function L(e,o,n,f,i,t){const a=N("AudioElement");return r(),c(y,null,[U,s("h2",null,"Play State: "+m(i.playing),1),E,S,i.createdNodes.musicGain?(r(),c("div",V,m(i.createdNodes.musicGain.gain.value),1)):p("",!0),i.createdNodes.noiseGain?(r(),c("div",P,m(i.createdNodes.noiseGain.gain.value),1)):p("",!0),u(a,{ref:"Microphone",key:"6",src:"window.location.origin + /sounds/debug/LMusik_RSprache.mp3",title:"Microphone","onUpdate:volume":t.updateNoiseGain},{default:l(({})=>[B]),_:1},8,["onUpdate:volume"]),u(a,{ref:"Noise",key:"5",src:i.noise_src,title:"Noise","onUpdate:volume":t.updateNoiseGain,"onUpdate:loaded":o[0]||(o[0]=g=>i.noiseReady=!0)},{default:l(({})=>[D]),_:1},8,["src","onUpdate:volume"]),u(a,{ref:"Music",key:"1",src:i.forest_src,title:"Forest","onUpdate:volume":t.updateMusicGain,"onUpdate:playing":t.handlePlayingUpdate,"onUpdate:fadeout":t.fadeOutGains,"onUpdate:loaded":o[1]||(o[1]=g=>i.musicReady=!0)},{default:l(({})=>[I]),_:1},8,["src","onUpdate:volume","onUpdate:playing","onUpdate:fadeout"])],64)}const k=G(M,[["render",L]]),q={__name:"NoiseMusicGainPlayPauseDevice",setup(e){return(o,n)=>(r(),c("div",null,[u(k)]))}};export{q as default};
